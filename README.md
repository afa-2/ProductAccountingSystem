# ProductAccountingSystem

-----Структра Файлов:-----
- Data (Здесь то, что хранится на сервере. База данных, медиа, статик файлы)
    - Database (База данных)
    - media (медиа файлы проекта)
    - static (статика проекта)
- Django (соответственно сам проект)
    - ProductAccountingSystem (сам проект)
    - Dockerfile
    - entrypoint.sh (набор команд, при формировании докер контейнера проекта)
    - requirements.txt (набор библиотек для проекта)
- Nginx (конфигурационные файлы сервера)
    - Dockerfile
    - my_nginx.conf (конфигурационный файл сервера)
    - uwsgi_params
- docker-compose.yml (ямл файл для запуска докер контейнеров)
- .config.env.dev (Файл, содержащий настройки и параметры проекта (Логины, пароли и прочее)
- deploy-prod.sh (Исполняемый файл, запускающий docker-compose, формирование и запуск контейнеров

-----Запуск------
Из комендной строки: ./deploy-prod.sh 

-----Что происходит------
При запуске deploy-prod.sh:
- Создается контейнер c django приложением. Настройки беруться из .config.env.dev
- Создается контейнер с базой данных MySQL. Если в папке Data/Database есть база данных, то контейнер подключается к ней, если нет, то содает новую.
- Создается контейнер с сервером Nginx. Конфигурация забирается и копируется в контейнер из my_nginx.conf и uwsgi_params

-----Принцип работы------
User <-> nginx (контейнер) <-> UWSGI + Django (контейнер)  <-> MySQL (контейнер)
Соотвественно, юзер общается через 80 порт с контейнером Nginx. Media и Static выдает Nginx, остальные запросы перенаправляет в Django. Общение между Nginx и UWSGI производится через 8001 порт. База данных (MySql) находится в отдельном контейнере.


-----!!!!ВАЖНО!!!!------
База данных, медиафайлы и статика хранятся в Data. Все остальные файлы востанавливаемы (например с гита), но удаление файлов в паке Data приведет к потере важных даннх. Эту папку и подпапки удалять нельязя.
